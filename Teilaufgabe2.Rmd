---
title: "Teilaufgabe2"
author: "Julia_Schneider"
date: "2023-11-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


Endpunkt Anzahl Raynaud-Attacken:

```{r}
library(tidyverse)
library(ggplot2)
library(readr)
Daten <- read_csv("Daten.csv")

#### To do: Achsen benennen, Farben 0 und 1, lila (Riskofaktor) und türkis

### kein Raynaud -> keine Attacken, Raynaud -> evtl. keine Attacken

#### Rauchen (ohne NA)
Daten_Rauchen <- data.frame (Daten$Rauchen, Daten$`Anzahl Raynaud Attacken`)
Daten_Rauchen <- na.omit(Daten_Rauchen) %>%
  group_by(Daten..Anzahl.Raynaud.Attacken., Daten.Rauchen) %>%
  summarise(count=n()) %>%
  arrange(factor(Daten..Anzahl.Raynaud.Attacken., levels = c('0', '<5', '<10', '>10', '>15', '>20'), ordered = TRUE))

order_level = c('0', '<5', '<10', '>10', '>15', '>20')

ggplot(Daten_Rauchen) + aes(x= factor(Daten..Anzahl.Raynaud.Attacken., level = c('0', '<5', '<10', '>10', '>15', '>20')), y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten.Rauchen) + xlab ("Anzahl Raynaud-Attacken")

## noch zu erledigen: Text hinter 0 und 1 entfernen oder Zeilen entfernen -> alle Raucher

#### Medikamente
Daten_Medikamente <- data.frame (Daten$Therapie, Daten$`Anzahl Raynaud Attacken`)
Daten_Medikamente <- na.omit(Daten_Medikamente) %>%
  group_by(Daten..Anzahl.Raynaud.Attacken., Daten.Therapie) %>%
  summarise(count=n()) %>%
  arrange(factor(Daten..Anzahl.Raynaud.Attacken., levels = c('0', '<5', '<10', '>10', '>15', '>20'), ordered = TRUE))

ggplot(Daten_Medikamente) + aes(x= factor(Daten..Anzahl.Raynaud.Attacken., level = c('0', '<5', '<10', '>10', '>15', '>20')), y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten.Therapie) + xlab ("Anzahl Raynaud-Attacken")

## Unterscheidung Gruppen


#### externe Phototherapie
Daten_Phototherapie <- data.frame (Daten$`ex. Photo.`, Daten$`Anzahl Raynaud Attacken`)
Daten_Phototherapie <- na.omit(Daten_Phototherapie) %>%
  group_by(Daten..Anzahl.Raynaud.Attacken., Daten..ex..Photo..) %>%
  summarise(count=n()) %>%
  arrange(factor(Daten..Anzahl.Raynaud.Attacken., levels = c('0', '<5', '<10', '>10', '>15', '>20'), ordered = TRUE))

ggplot(Daten_Phototherapie) + aes(x= factor(Daten..Anzahl.Raynaud.Attacken., level = c('0', '<5', '<10', '>10', '>15', '>20')), y=count) +
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..ex..Photo..) + xlab ("Anzahl Raynaud-Attacken")


#### Corona
Daten_Corona <- data.frame (Daten$`Corona Infektion`, Daten$`Anzahl Raynaud Attacken`)
Daten_Corona <- na.omit(Daten_Corona) %>%
  group_by(Daten..Anzahl.Raynaud.Attacken., Daten..Corona.Infektion.) %>%
  summarise(count=n()) %>%
  arrange(factor(Daten..Anzahl.Raynaud.Attacken., levels = c('0', '<5', '<10', '>10', '>15', '>20'), ordered = TRUE))

ggplot(Daten_Corona) + aes(x= factor(Daten..Anzahl.Raynaud.Attacken., level = c('0', '<5', '<10', '>10', '>15', '>20')), y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..Corona.Infektion.) + xlab ("Anzahl Raynaud-Attacken")


## Auswirkungen miteinbeziehen?


#### Psychotherapie
Daten_Psycho <- data.frame (Daten$Psychotherapie, Daten$`Anzahl Raynaud Attacken`)
Daten_Psycho <- na.omit(Daten_Psycho) %>%
  group_by(Daten..Anzahl.Raynaud.Attacken., Daten.Psychotherapie) %>%
  summarise(count=n()) %>%
  arrange(factor(Daten..Anzahl.Raynaud.Attacken., levels = c('0', '<5', '<10', '>10', '>15', '>20'), ordered = TRUE))

ggplot(Daten_Psycho) + aes(x= factor(Daten..Anzahl.Raynaud.Attacken., level = c('0', '<5', '<10', '>10', '>15', '>20')), y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten.Psychotherapie)+ xlab ("Anzahl Raynaud-Attacken")

## 2 zu 1 hinzufügen 


#### Sport
Daten_Sport <- data.frame (Daten$`Sport/w`, Daten$`Anzahl Raynaud Attacken`)
Daten_Sport <- na.omit(Daten_Sport) %>%
  group_by(Daten..Anzahl.Raynaud.Attacken., Daten..Sport.w.) %>%
  summarise(count=n()) %>%
  arrange(factor(Daten..Anzahl.Raynaud.Attacken., levels = c('0', '<5', '<10', '>10', '>15', '>20'), ordered = TRUE))

ggplot(Daten_Sport) + aes(x= factor(Daten..Anzahl.Raynaud.Attacken., level = c('0', '<5', '<10', '>10', '>15', '>20')), y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..Sport.w.) + xlab ("Anzahl Raynaud-Attacken")

## Unterscheidung Sport oder kein Sport

#### Physiotherapie
Daten_Physio <- data.frame (Daten$`Physiotherapie in der Woche`, Daten$`Anzahl Raynaud Attacken`)
Daten_Physio <- na.omit(Daten_Physio) %>%
  group_by(Daten..Anzahl.Raynaud.Attacken., Daten..Physiotherapie.in.der.Woche.) %>%
  summarise(count=n()) %>%
  arrange(factor(Daten..Anzahl.Raynaud.Attacken., levels = c('0', '<5', '<10', '>10', '>15', '>20'), ordered = TRUE))

ggplot(Daten_Physio) + aes(x= factor(Daten..Anzahl.Raynaud.Attacken., level = c('0', '<5', '<10', '>10', '>15', '>20')), y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..Physiotherapie.in.der.Woche.) + xlab ("Anzahl Raynaud-Attacken")

# Unterscheidung Physio oder keine Physio
```


Endpunkt Raynaud ja/nein

```{r}
#### Rauchen (ohne NA)
Daten_Rauchen_2 <- data.frame (Daten$Rauchen, Daten$Raynaud)
Daten_Rauchen_2 <- na.omit(Daten_Rauchen_2) %>%
  group_by(Daten.Raynaud, Daten.Rauchen) %>%
  summarise(count=n()) 

ggplot(Daten_Rauchen_2) + aes(x= Daten.Raynaud, y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten.Rauchen) + xlab ("Raynaud-Syndrom")

## noch zu erledigen: Text hinter 0 und 1 entfernen oder Zeilen entfernen

#### Medikamente
Daten_Medikamente_2 <- data.frame (Daten$Therapie, Daten$Raynaud)
Daten_Medikamente_2 <- na.omit(Daten_Medikamente_2) %>%
  group_by(Daten.Raynaud, Daten.Therapie) %>%
  summarise(count=n()) 

ggplot(Daten_Medikamente_2) + aes(x= Daten.Raynaud, y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten.Therapie) + xlab ("Raynaud")

## Unterscheidung Gruppen


#### externe Phototherapie
Daten_Phototherapie_2 <- data.frame (Daten$`ex. Photo.`, Daten$Raynaud)
Daten_Phototherapie_2 <- na.omit(Daten_Phototherapie_2) %>%
  group_by(Daten.Raynaud, Daten..ex..Photo..) %>%
  summarise(count=n()) 

ggplot(Daten_Phototherapie_2) + aes(x= Daten.Raynaud, y=count) +
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..ex..Photo..) + xlab ("Raynaud")


#### Corona
Daten_Corona_2 <- data.frame (Daten$`Corona Infektion`, Daten$Raynaud)
Daten_Corona_2 <- na.omit(Daten_Corona_2) %>%
  group_by(Daten.Raynaud, Daten..Corona.Infektion.) %>%
  summarise(count=n()) 

ggplot(Daten_Corona_2) + aes(x= Daten.Raynaud, y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..Corona.Infektion.) + xlab ("Raynaud")


## Auswirkungen?


#### Psychotherapie
Daten_Psycho_2 <- data.frame (Daten$Psychotherapie, Daten$Raynaud)
Daten_Psycho_2 <- na.omit(Daten_Psycho_2) %>%
  group_by(Daten.Raynaud, Daten.Psychotherapie) %>%
  summarise(count=n()) 

ggplot(Daten_Psycho_2) + aes(x= Daten.Raynaud, y=count)+ 
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten.Psychotherapie)+ xlab ("Raynaud")


#### Sport
Daten_Sport_2 <- data.frame (Daten$`Sport/w`, Daten$Raynaud)
Daten_Sport_2 <- na.omit(Daten_Sport_2) %>%
  group_by(Daten.Raynaud, Daten..Sport.w.) %>%
  summarise(count=n()) 

ggplot(Daten_Sport_2) + aes(x= Daten.Raynaud, y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..Sport.w.) + xlab ("Raynaud")


#### Physiotherapie
Daten_Physio_2 <- data.frame (Daten$`Physiotherapie in der Woche`, Daten$Raynaud)
Daten_Physio_2 <- na.omit(Daten_Physio_2) %>%
  group_by(Daten.Raynaud, Daten..Physiotherapie.in.der.Woche.) %>%
  summarise(count=n()) 

ggplot(Daten_Physio_2) + aes(x= Daten.Raynaud, y=count)+
  geom_bar(stat='identity', fill="forest green")+
  facet_wrap(~Daten..Physiotherapie.in.der.Woche.) + xlab ("Raynaud")




